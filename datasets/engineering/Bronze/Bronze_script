%md
#READING FROM CSV FILE
%sql
DROP TABLE IF EXISTS bronze.crm_cust_info;
%sql
CREATE TABLE bronze.crm_cust_info (
  cst_id INT,
  cst_key VARCHAR(50),
  cst_firstname VARCHAR(50),
  cst_lastname VARCHAR(50),
  cst_marital_status VARCHAR(50),
  cst_gndr VARCHAR(50),
  cst_create_date DATE
)
%sql
DROP TABLE IF EXISTS bronze.crm_prd_info;
%sql
CREATE TABLE bronze.crm_prd_info (
  prd_id INT,
  prd_key VARCHAR(50),
  prd_nm VARCHAR(50),
  prd_cost INT,
  prd_line VARCHAR(50),
  prd_start_dt DATE,
  prd_end_dt DATE
)
%sql
DROP TABLE IF EXISTS bronze.crm_sales_details;
%sql
CREATE TABLE bronze.crm_sales_details (
  sls_ord_num VARCHAR(50),
  sls_prd_key VARCHAR(50),
  sls_cust_id INT,
  sls_order_dt INT,
  sls_ship_dt INT,
  sls_due_dt INT,
  sls_sales INT,
  sls_quantity INT,
  sls_price INT
)
%sql
DROP TABLE IF EXISTS bronze.erp_cust_az12;
%sql
CREATE TABLE bronze.erp_cust_az12 (
  cid VARCHAR(50),
  bdate DATE,
  gen VARCHAR(50)
)
%sql
DROP TABLE IF EXISTS bronze.erp_loc_a101;
%sql
CREATE TABLE bronze.erp_loc_a101 (
  cid VARCHAR(50),
  cntry VARCHAR(50)
)
%sql
DROP TABLE IF EXISTS bronze.erp_px_cat_g1v2;
%sql
CREATE TABLE bronze.erp_px_cat_g1v2 (
  id VARCHAR(50),
  cat VARCHAR(50),
  subcat VARCHAR(50),
  maintenance VARCHAR(50)
)
%md
#Write it to Bronze Layer
%md
Load Bronze CRM CUST_INFO
df = (
    spark.read
         .option("header", "true")
         .option("inferSchema", "true")
         .csv("/Volumes/workspace/bronze/source_system/source_crm/cust_info.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.crm_cust_info")
%md
Load Bronze CRM PRD_INFO
df = (
    spark.read
    .option("header", "true")
    .option("inferSchema", "true")
    .csv("/Volumes/workspace/bronze/source_system/source_crm/prd_info.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.crm_prd_info")
%md
Load Bronze CRM SALES_DETAILS
df = (
    spark.read
    .option("header", "true")
    .option("inferSchema", "true")
    .csv("/Volumes/workspace/bronze/source_system/source_crm/sales_details.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.crm_sales_details")
%md
Load Bronze ERP CUST AZ12
df = (
    spark.read
    .option("header", "true")
    .option("inferSchema", "true")
    .csv("/Volumes/workspace/bronze/source_system/source_erp/CUST_AZ12.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.erp_CUST_AZ12")
%md
Load Bronze ERP LOC A101
df = (
    spark.read
    .option("header", "true")
    .option("inferSchema", "true")
    .csv("/Volumes/workspace/bronze/source_system/source_erp/LOC_A101.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.erp_LOC_A101")
%md
Load Bronze ERP PX CAT G1V2
df = (
    spark.read
    .option("header", "true")
    .option("inferSchema", "true")
    .csv("/Volumes/workspace/bronze/source_system/source_erp/PX_CAT_G1V2.csv")
)
df.write.mode("overwrite").saveAsTable("bronze.erp_PX_CAT_G1V2")
